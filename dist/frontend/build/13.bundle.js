(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{399:function(e,t,n){"use strict";var a=n(30),r=n.n(a),o=n(1),i=n.n(o),s=n(410),c=n.n(s),l=Object(o.forwardRef)((function(e,t){var n=e.value,a=e.classNames,s=e.onChange,l=e.onBlur,f=e.onKeyDown,p=e.onKeyPress,d=e.onKeyUp,u=e.maxLength,m=e.disabled,g=e.placeholder,b=e.name,x=e.spellCheck,h=void 0!==x&&x,v=e.errorMessage,_=Object(o.useState)(n),y=r()(_,2),w=y[0],N=y[1];return Object(o.useEffect)((function(){N(n)}),[n]),i.a.createElement("div",null,i.a.createElement("textarea",{className:"\n          ".concat(c.a.textarea,"\n          ").concat(a&&a,"\n        "),ref:t,placeholder:g,value:w,onChange:function(e){s&&s(e),N(e.target.value)},onBlur:function(e){l&&l(e)},onKeyDown:function(e){f&&f(e)},onKeyPress:p,onKeyUp:d,maxLength:u,disabled:m,name:b,spellCheck:h}),i.a.createElement("div",null,v))}));t.a=l},410:function(e,t,n){var a=n(38),r=n(411);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},411:function(e,t,n){"use strict";n.r(t);var a=n(24),r=n.n(a)()(!1);r.push([e.i,".hRS2SSXVbNe3ynZqI82NM{resize:none;white-space:pre-wrap;padding:10px;font-size:14px;width:100%;border-radius:3px;border:1px solid #dadada;box-sizing:border-box;outline:none;height:75px;transition:.3s all}.hRS2SSXVbNe3ynZqI82NM:focus{border-color:#0a86f9}",""]),r.locals={white1:"#fff",blue1:"#0084ff",blue10:"#f4fffd",blue11:"#f4f9ff",brown10:"#363636",green3:"#f5fff5",green4:"#faffec",green5:"#fbfff2",red1:"snow",grey23:"#ccc",textarea:"hRS2SSXVbNe3ynZqI82NM"},t.default=r},524:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e){if(e){var t=e.scrollHeight;e.scrollBy(0,t)}}},740:function(e,t,n){var a=n(38),r=n(741);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},741:function(e,t,n){"use strict";n.r(t);var a=n(24),r=n.n(a)()(!1);r.push([e.i,'._3sVnFCtHF_SJasYNkaHiYk{display:flex;flex-direction:column;margin-bottom:20px;position:relative;opacity:0}._3qqgxBtc0Q20Msq3ENpn3r{align-items:flex-start}._1xS_KwyB1xh7UFJiGYTr5L{align-items:flex-end}._2AhqDXi4IuqUZyb8YM38Tc{display:flex;align-items:flex-end}._10PIp87YcdybqVKV0-9rQA{width:300px;margin-bottom:5px;padding:10px;border-radius:18px;font-size:14px}._1mpYT44qRLTKi1d27QriSS{position:relative;background:#0a86f9;color:#fff;margin-left:8px}._1mpYT44qRLTKi1d27QriSS::before{content:"";position:absolute;bottom:-2px;height:20px;z-index:-2;left:-7px;border-left:20px solid #0a86f9;border-bottom-right-radius:16px 14px;transform:translateY(-2px)}._1mpYT44qRLTKi1d27QriSS::after{content:"";position:absolute;bottom:-2px;height:20px;z-index:-1;left:4px;width:26px;background:#fff;border-bottom-right-radius:10px;transform:translate(-30px, -2px)}._2YFCsHWrRBNzkSf7t-9cNb{position:relative;background:#f0f0f0;margin-left:auto;margin-right:8px;color:#464646}._2YFCsHWrRBNzkSf7t-9cNb::before{content:"";position:absolute;bottom:-2px;height:20px;z-index:-2;right:-7px;border-right:20px solid #f0f0f0;border-bottom-left-radius:16px 14px;transform:translateY(-2px)}._2YFCsHWrRBNzkSf7t-9cNb::after{content:"";position:absolute;bottom:-2px;height:20px;z-index:-1;right:4px;width:26px;background:#fff;border-bottom-left-radius:10px;transform:translate(30px, -2px)}._1Ssz3wuzTcu_HzQ366mz2X{font-size:12px;color:#3e3e3e;opacity:.35}._1LtgSpoKVwhuAAUet7Ld1i{margin-left:35px}._30ARI7Zs0-qf6pTe_JY9Z9{margin-right:35px}',""]),r.locals={white1:"#fff",blue1:"#0084ff",blue10:"#f4fffd",blue11:"#f4f9ff",brown10:"#363636",green3:"#f5fff5",green4:"#faffec",green5:"#fbfff2",red1:"snow",grey23:"#ccc",messageInnerContainer:"_3sVnFCtHF_SJasYNkaHiYk",messageInnerContainerLeft:"_3qqgxBtc0Q20Msq3ENpn3r",messageInnerContainerRight:"_1xS_KwyB1xh7UFJiGYTr5L",messageBody:"_2AhqDXi4IuqUZyb8YM38Tc",messageWrapper:"_10PIp87YcdybqVKV0-9rQA",clientMessage:"_1mpYT44qRLTKi1d27QriSS",teammateMessage:"_2YFCsHWrRBNzkSf7t-9cNb",creationTime:"_1Ssz3wuzTcu_HzQ366mz2X",creationTimeClient:"_1LtgSpoKVwhuAAUet7Ld1i",creationTimeTeammate:"_30ARI7Zs0-qf6pTe_JY9Z9"},t.default=r},742:function(e,t,n){var a=n(38),r=n(743);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},743:function(e,t,n){"use strict";n.r(t);var a=n(24),r=n.n(a)()(!1);r.push([e.i,"._37Adnwu_7K_N0UckvossZe{position:sticky;bottom:0;left:0;width:100%;height:90px;border-top:1px solid #e9e9e9;background:#fff;display:flex;align-items:center}._3mZBlLeN0SEBv4cjg_DFeq{width:100%;padding:15px 20px;height:88px;box-sizing:border-box;border:none;border-top:1px solid #e9e9e9;border-radius:0;outline:none;background:#fff}._3mZBlLeN0SEBv4cjg_DFeq:focus{border-color:#e9e9e9}._11Uje-BeH5Rh3tqjk_XH_U{font-size:13px;color:#777;padding:0 15px}._2fK80XEkOR8kIvNts7GQQF{cursor:pointer;padding:10px 20px}._2fK80XEkOR8kIvNts7GQQF:hover{background:#f4f4f4}.J3f-r2ogRzorMy5xFjomI{font-size:14px;color:#333;font-weight:500;margin-bottom:5px}._35RTsdKZ7jt9SwpTVR8iq-{font-size:13px;color:#777}._2dEmfM_2L06hp0uakprY7M{padding:7px 5px;text-decoration:none;color:#fff;font-weight:500;background:#00c200;border-radius:3px;width:100%;display:inline-block;box-sizing:border-box}._1yt3_Xd6KdhdCcSkdQQ4ET{width:230px;text-align:center;margin:15px auto 0;font-size:14px}._2qYFns6B_nSVzv1PgfV_yr{font-size:13px;margin-top:14px;color:#909090}.A0qxcFn6oIdzF2FWu7glo{position:sticky;bottom:0}",""]),r.locals={white1:"#fff",blue1:"#0084ff",blue10:"#f4fffd",blue11:"#f4f9ff",brown10:"#363636",green3:"#f5fff5",green4:"#faffec",green5:"#fbfff2",red1:"snow",grey23:"#ccc",appointedContainer:"_37Adnwu_7K_N0UckvossZe",inputArea:"_3mZBlLeN0SEBv4cjg_DFeq",noMatchesFound:"_11Uje-BeH5Rh3tqjk_XH_U",templateEntity:"_2fK80XEkOR8kIvNts7GQQF",templateName:"J3f-r2ogRzorMy5xFjomI",templateMessage:"_35RTsdKZ7jt9SwpTVR8iq-",appointDialogLink:"_2dEmfM_2L06hp0uakprY7M",appointedArea:"_1yt3_Xd6KdhdCcSkdQQ4ET",appointedNotice:"_2qYFns6B_nSVzv1PgfV_yr",messagesInputArea:"A0qxcFn6oIdzF2FWu7glo"},t.default=r},744:function(e,t,n){var a=n(38),r=n(745);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},745:function(e,t,n){"use strict";n.r(t);var a=n(24),r=n.n(a)()(!1);r.push([e.i,"._1EQf_105SWmABcSAgDjk9w{position:relative;width:470px;border-right:1px solid #e9e9e9;flex-grow:1}.XJGvYIsiTggrZyLjb60hf{width:150px}.zK5kLL3g929dKknAigLN-{display:flex;align-items:center;padding:0 20px}._1OLddKNoQQzMpEo3tinFSH{height:calc(100vh - 203px);overflow-y:auto;padding:0 10px}._16kVqpl4H0kxX6xg7NZxT_{font-weight:500;width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._1B4m8pdC9x7gAXAFVgXKNS{margin:0 13px 0 auto}._2915wTqftYIExxwtlo7huB{opacity:.25;cursor:pointer}._3AComGJjVjw65qsyfMOhYi{padding:20px;font-size:14px}._2qc-1h4U4vkJublWz-hx-N{display:flex;justify-content:flex-end;padding:0 15px 20px}._3dycMEQRwugaez3EXgC5-K{width:110px;height:40px}@keyframes Wt9iWLpmpliWe5N5NPSYj{0%{opacity:0;top:-20px}100%{opacity:1;top:0}}.Wk_C8MkAts3G6gnO6ut4h{animation:Wt9iWLpmpliWe5N5NPSYj .3s ease forwards}._1rHsDfHS92c5C1HiUeRp0Z{padding:9px 30px 10px;font-size:13px;font-weight:400}._1sxyWL4WD8lvWg9yMYcVr5{margin-right:10px}._3HD_5q-U5dmiWeWbPCMNMA{color:#0a86f9;font-size:13px;padding:6px 0}",""]),r.locals={white1:"#fff",blue1:"#0084ff",blue10:"#f4fffd",blue11:"#f4f9ff",brown10:"#363636",green3:"#f5fff5",green4:"#faffec",green5:"#fbfff2",red1:"snow",grey23:"#ccc",converasationChatContainer:"_1EQf_105SWmABcSAgDjk9w",buttonContainer:"XJGvYIsiTggrZyLjb60hf",dialogHeader:"zK5kLL3g929dKknAigLN-",messagesHistoryContainer:"_1OLddKNoQQzMpEo3tinFSH",clientName:"_16kVqpl4H0kxX6xg7NZxT_",archiveIconContainer:"_1B4m8pdC9x7gAXAFVgXKNS",iconArchive:"_2915wTqftYIExxwtlo7huB",modalBody:"_3AComGJjVjw65qsyfMOhYi",modalFooter:"_2qc-1h4U4vkJublWz-hx-N",modalButton:"_3dycMEQRwugaez3EXgC5-K",animationClass:"Wk_C8MkAts3G6gnO6ut4h",slideDown:"Wt9iWLpmpliWe5N5NPSYj",button:"_1rHsDfHS92c5C1HiUeRp0Z",marginRight:"_1sxyWL4WD8lvWg9yMYcVr5",closeDialogBtn:"_3HD_5q-U5dmiWeWbPCMNMA"},t.default=r},768:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return F}));var a=n(8),r=n.n(a),o=n(1),i=n.n(o),s=n(10),c=n(80),l=n(81),f=n(393),p=n(2),d=n.n(p),u=(n(88),n(420)),m=n(740),g=n.n(m),b=n(391);function x(e){var t=e.message,n=Object(b.a)((function(e){return e.inbox})).selectedClient;return i.a.createElement("div",{className:"\n        ".concat(g.a.messageInnerContainer,"\n        ").concat("client"===t.username?g.a.messageInnerContainerLeft:g.a.messageInnerContainerRight,"\n      ")},i.a.createElement("div",{className:g.a.messageBody},"client"===t.username&&i.a.createElement(u.a,{name:n.avatarName,color:n.avatarColor,size:"26px"}),i.a.createElement("div",{className:"".concat("client"===t.username?g.a.clientMessage:g.a.teammateMessage," ").concat(g.a.messageWrapper),dangerouslySetInnerHTML:{__html:t.message}})),i.a.createElement("div",{className:"\n          ".concat(g.a.creationTime,"\n          ").concat("client"===t.username?g.a.creationTimeClient:g.a.creationTimeTeammate,"\n        ")},function(e){if(e){var t=d()(e);return t.locale("ru"),t.format("HH:mm")}return null}(t.timestamp)))}var h=n(30),v=n.n(h),_=n(31),y=n(407),w=n(399),N=n(9),j=n(742),C=n.n(j),E=n(524),k=n(55),O=n(79),S=n(82);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e){var t=e.messagesHistoryContainerElement,n=Object(s.i)().projectId,a=Object(o.useContext)(S.a).currentUser,r=Object(o.useRef)(null),c=Object(b.a)((function(e){return e.inbox})).selectedClient,l=Object(b.a)((function(e){return e.templates})).templates,f=Boolean(c.assignedTo),p=Object(O.a)(),d=p.addIncomingMessage,u=p.addIncomingMessageForSelectedClient,m=p.addToInboxIncomingMessage,g=p.fetchTemplates,x=p.changeMessagesStatus,h=Object(o.useState)(!1),j=v()(h,2),I=j[0],z=j[1],T=Object(o.useState)(""),q=v()(T,2),L=q[0],H=q[1],A=Object(o.useState)(""),F=v()(A,2),K=F[0],Y=F[1],R=function(){return l.filter((function(e){var t=e.name.toLowerCase(),n=L.toLowerCase();return t.includes(n)}))},B=function(){var e=R();return i.a.createElement("div",{className:C.a.templatesContainer},e.length>0?e.map((function(e){var t=e.id,n=e.name,a=e.message;return i.a.createElement("div",{key:t,className:C.a.templateEntity,onClick:function(){return function(e){var t=Object(k.b)(e);Y(t),r.current&&r.current.focus(),z(!1)}(a)}},i.a.createElement("div",{className:C.a.templateName},n),i.a.createElement("div",{className:C.a.templateMessage,dangerouslySetInnerHTML:{__html:a}}))})):i.a.createElement("p",{className:C.a.noMatchesFound},"Совпадений не найдено"))};return Object(o.useEffect)((function(){g({projectId:n})}),[]),Object(o.useEffect)((function(){var e=r.current;e&&e.focus(),Object(E.a)(t)}),[c]),i.a.createElement(i.a.Fragment,null,f?i.a.createElement("div",{className:C.a.messagesInputArea},i.a.createElement(y.a,{body:i.a.createElement(B,null),width:"100%",isOpenPopup:I,position:"top"},i.a.createElement(w.a,{ref:r,classNames:C.a.inputArea,value:K,placeholder:"Введите символ /, чтобы использовать быстрые ответы",onKeyUp:function(e){return function(e){var t=e.target.value;t.includes("/")?(z(!0),H(t.substr(1))):z(!1)}(e)},onChange:function(e){return Y(e.target.value)},onKeyPress:function(e){var a=e.target.value;if(!e.shiftKey)if(0!==a.indexOf("\n")){var r=Object(k.c)(a);r&&13===e.which&&function(e){var a=e,r=Date.now(),o={clientId:c.clientId,username:"operator",message:a,timestamp:r,assignedTo:c.assignedTo};m({clientId:c.clientId,projectId:n,message:o,timestamp:r,successCallback:function(){d({clientId:c.clientId,projectId:n,messagesHistory:[o]}),u(o),Y(""),Object(E.a)(t),N.a.emit("operatorMessageFromInfochat",{room:c.clientId,message:{clientId:c.clientId,projectId:n,message:o,timestamp:r}})}})}(r)}else Y("")}}))):i.a.createElement("div",{className:C.a.appointedContainer},i.a.createElement("div",{className:C.a.appointedArea},i.a.createElement(_.b,{to:"/project/".concat(n,"/inbox/opened"),onClick:function(){var e={messagesStatus:"opened",assignedTo:a.email,projectId:n,clientId:c.clientId};x(M(M({},e),{},{successCallback:function(){N.a.emit("changeMessagesStatus",e)}}))},className:C.a.appointDialogLink},"Взять в работу"),i.a.createElement("p",{className:C.a.appointedNotice},"Диалог будет закреплен за вами"))))}var T=n(744),q=n.n(T),L=n(86);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e){var t,n,a,r=e.clientName,p=e.messagesHistory,d=e.clientId,u=e.closeModal,m=e.setModalProps,g=Object(b.a)((function(e){return e.inbox})),h=g.incomingMessages,v=g.selectedClient,_=Object(O.a)(),y=_.changeMessagesStatus,w=_.deleteClientAppeal,j=_.updateSelectedClient,C=_.deleteFromInboxIncomingMessage,E=Object(s.i)().projectId,k=Object(o.useRef)(null),S=function(){return i.a.createElement("p",{className:q.a.modalBody},"Вы действительно хотите удалить обращение?")},I=function(){return i.a.createElement("div",{className:q.a.modalFooter},i.a.createElement(f.a,{type:"button",classNames:"".concat(q.a.button," ").concat(q.a.marginRight),background:"edit",onClick:function(){return u()}},"Отмена"),i.a.createElement(f.a,{type:"button",classNames:q.a.button,onClick:function(){w({clientId:d,projectId:E,successCallback:function(){return j(L.a),C({clientId:d}),N.a.emit("updateSelectedClient",L.a),N.a.emit("deleteFromInboxIncomingMessage",{clientId:d}),void u()}})}},"Удалить"))},M=(t=d,n=Object(o.useRef)(),Object(o.useEffect)((function(){n.current=t})),n.current);return Object(o.useEffect)((function(){var e=k.current;if(e){var t=e.children,n=t.length;return function(e,t){for(var n=function(n){var a=t[n-1];setTimeout((function(){a.classList.contains(q.a.animationClass)||(a.className=a.className.concat(" ".concat(q.a.animationClass)))}),50*(e-n))},a=e;a>0;a--)n(a)}(n,t),function(){M!==d&&function(e,t){for(var n=e;n>0;n--){var a=t[n-1];null==a||a.classList.remove(q.a.animationClass)}}(n,t)}}}),[d,v.messagesHistory]),i.a.createElement("div",{className:q.a.converasationChatContainer},i.a.createElement("div",{className:q.a.dialogHeader},i.a.createElement("div",null,i.a.createElement("p",{className:q.a.clientName},r)),i.a.createElement("div",{onClick:function(){m({show:!0,title:"Удалить обращение?",body:i.a.createElement(S,null),footer:i.a.createElement(I,null),width:"500px",position:"top",onClose:u})},className:q.a.archiveIconContainer},i.a.createElement(c.a,{icon:l.a,className:q.a.iconArchive})),i.a.createElement("div",{className:q.a.buttonContainer},i.a.createElement(f.a,{type:"button",fluid:!0,background:"edit",classNames:q.a.closeDialogBtn,onClick:function(){var e={messagesStatus:"closed",projectId:E,clientId:d};y(A(A({},e),{},{successCallback:function(){return N.a.emit("changeMessagesStatus",e)}}))},disabled:!(null!==(a=h.find((function(e){return e.clientId===d})))&&void 0!==a&&a.assignedTo)},"Закрыть диалог"))),i.a.createElement("div",{className:q.a.messagesHistoryContainer,ref:k},p.map((function(e,t){return i.a.createElement(x,{key:t,message:e})}))),i.a.createElement(z,{messagesHistoryContainerElement:k.current}))}}}]);